#include "LOOL_OLED.h"



/* Private variables ---------------------------------------------------------*/
volatile uint8_t LOOL_OLED::_AD0 = 0;
volatile uint8_t LOOL_OLED::_INT = 0;

/* Private functions ---------------------------------------------------------*/
#ifdef LOOL_PORT_DEFINED
/**
 * Alternate Constructor which can call your own function to map the LOOL_OLED to arduino port,
 * no pins are used or initialized here
 */
LOOL_OLED::LOOL_OLED(void) : LOOL_Port(0)
{
  _i2caddr = SSD1306_I2C_ADDRESS;
}

/**
 * Alternate Constructor which can call your own function to map the LOOL_OLED to arduino port,
 * no pins are used or initialized here, but PWM frequency set to 976 Hz
 * param[in]
 *   port - RJ25 port from PORT_1 to M2
 */
LOOL_OLED::LOOL_OLED(uint8_t port) : LOOL_Port(port)
{
  _i2caddr = SSD1306_I2C_ADDRESS;
}

/**
 * Alternate Constructor which can call your own function to map the LOOL_OLED to arduino port
 * and change the i2c device address
 * no pins are used or initialized here, but PWM frequency set to 976 Hz
 * param[in]
 *   port - RJ25 port from PORT_1 to M2
 * param[in]
 *   address - the i2c address you want to set
 */
LOOL_OLED::LOOL_OLED(uint8_t port, uint8_t address) : LOOL_Port(port)
{
  _i2caddr = address;
}
#else  // LOOL_PORT_DEFINED
/**
 * Alternate Constructor which can call your own function to map the _AD0 and _INT to arduino port,
 * no pins are used or initialized here
 * param[in]
 *   _AD0 - arduino gpio number
 * param[in]
 *   _INT - arduino gpio number
 */
LOOL_OLED::LOOL_OLED(uint8_t AD0, uint8_t INT)
{
  _i2caddr = SSD1306_I2C_ADDRESS;
  _AD0 = AD0;
  _INT = INT;
}

/**
 * Alternate Constructor which can call your own function to map the _AD0 and _INT to arduino port
 * and change the i2c device address, no pins are used or initialized here
 * param[in]
 *   _AD0 - arduino gpio number
 * param[in]
 *   _INT - arduino gpio number
 * param[in]
 *   address - the i2c address you want to set
 */
LOOL_OLED::LOOL_OLED(uint8_t AD0, uint8_t INT, uint8_t address)
{
  Device_Address = address;
  _AD0 = AD0;
  _INT = INT;
}
#endif // LOOL_PORT_DEFINED

/**
 * @par Function
 *   setpin
 * @par Description
 *   Set the PIN of the button module.
 * param[in]
 *   AD0 - pin mapping for arduino
 * param[in]
 *   INT - pin mapping for arduino
 * @par Output
 *   None
 * return
 *   None.
 * @par Others
 *   Set global variable _AD0, _INT, s1 and s2
 */
void LOOL_OLED::setpin(uint8_t AD0, uint8_t INT)
{
  _AD0 = AD0;
  _INT = INT;
#ifdef LOOL_PORT_DEFINED
  s1 = AD0;
  s2 = INT;
#endif // LOOL_PORT_DEFINED
}
void LOOL_OLED::begin() {
    _i2caddr = 0x3C;

     Wire.begin(); // Is this the right place for this?
	 delayMicroseconds(50);
    ssd1306_command(SSD1306_DISPLAYOFF);                    // 0xAE
    ssd1306_command(SSD1306_SETDISPLAYCLOCKDIV);            // 0xD5
    ssd1306_command(0x80);                                  // the suggested ratio 0x80
    ssd1306_command(SSD1306_SETMULTIPLEX);                  // 0xA8
    ssd1306_command(0x3F);
    ssd1306_command(SSD1306_SETDISPLAYOFFSET);              // 0xD3
    ssd1306_command(0x0);                                   // no offset
    ssd1306_command(SSD1306_SETSTARTLINE | 0x0);            // line #0
    ssd1306_command(SSD1306_CHARGEPUMP);                    // 0x8D
    ssd1306_command(0x14);
    ssd1306_command(SSD1306_MEMORYMODE);                    // 0x20
    ssd1306_command(0x00);                                  // 0x0 act like ks0108
    ssd1306_command(SSD1306_SEGREMAP | 0x1);
    ssd1306_command(SSD1306_COMSCANDEC);
    ssd1306_command(SSD1306_SETCOMPINS);                    // 0xDA
    ssd1306_command(0x12);
    ssd1306_command(SSD1306_SETCONTRAST);                   // 0x81
    ssd1306_command(0xCF); 
    ssd1306_command(SSD1306_SETPRECHARGE);                  // 0xd9
    ssd1306_command(0xF1); 
    ssd1306_command(SSD1306_SETVCOMDETECT);                 // 0xDB
    ssd1306_command(0x40);
    ssd1306_command(SSD1306_DISPLAYALLON_RESUME);           // 0xA4
    ssd1306_command(SSD1306_NORMALDISPLAY);                 // 0xA6  
	ssd1306_command(SSD1306_DISPLAYON);//--turn on oled panel
	clearDisplay();
}
void LOOL_OLED::ssd1306_command(unsigned char c) { 
    // I2C
    unsigned char control = 0x00;   // Co = 0, D/C = 0
    Wire.beginTransmission(_i2caddr);
    Wire.write(control);
    Wire.write(c);
    Wire.endTransmission();
}
void LOOL_OLED::ssd1306_data(unsigned char c) {
    // I2C
    unsigned char control = 0x40;   // Co = 0, D/C = 1
    Wire.beginTransmission(_i2caddr);
    Wire.write(control);
    Wire.write(c);
    Wire.endTransmission();
}
void LOOL_OLED::Set_Pos(unsigned char x, unsigned char y){

  ssd1306_command(0xb0+y);
  ssd1306_command(((x&0xf0)>>4)|0x10);
ssd1306_command((x&0x0f)|0x01); 

}

void LOOL_OLED::display(void) {
  int x=50,y=5;
  ssd1306_command(0xb0+y);
  ssd1306_command(((x&0xf0)>>4)|0x10);
ssd1306_command((x&0x0f)|0x01); 

      Wire.beginTransmission(_i2caddr);
      Wire.write(0x40);
      Wire.write(0x00);
      Wire.write(0x42);
      Wire.write(0x61);
      Wire.write(0x51);
      Wire.write(0x49);
      Wire.write(0x46);
      Wire.endTransmission();

}

// clear everything
void LOOL_OLED::clearDisplay(unsigned char m) {
  ssd1306_command(0xb0+m);
  ssd1306_command(0x00);
  ssd1306_command(0x10); 
 
    for(int x=0;x<128;x++)
    {
        Wire.beginTransmission(_i2caddr);
        Wire.write(0x40);
        Wire.write(0x00);//Wire.write(0x00);Wire.write(0x00);Wire.write(0x00);Wire.write(0x00);Wire.write(0x00);
        Wire.endTransmission();
    }

}
// clear everything
void LOOL_OLED::clearDisplay() {
	for(uint8_t i=0;i<8;i++)
	{
  ssd1306_command(0xb0+i);
  ssd1306_command(0x00);
  ssd1306_command(0x10); 
 
    for(int x=0;x<128;x++)
    {
        Wire.beginTransmission(_i2caddr);
        Wire.write(0x40);
        Wire.write(0x00);//Wire.write(0x00);Wire.write(0x00);Wire.write(0x00);Wire.write(0x00);Wire.write(0x00);
        Wire.endTransmission();
    }
  }
}
PROGMEM const  char  shuziTab1[]  = {                    //daxing
0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,//0
0x00,0x00,0x10,0x10,0xF8,0x00,0x00,0x00,//1
0x00,0x70,0x08,0x08,0x08,0x08,0xF0,0x00,//2
0x00,0x30,0x08,0x08,0x08,0x88,0x70,0x00,//3
0x00,0x00,0x80,0x40,0x30,0xF8,0x00,0x00,//4
0x00,0xF8,0x88,0x88,0x88,0x08,0x08,0x00,//5
0x00,0xE0,0x10,0x88,0x88,0x90,0x00,0x00,//6
0x00,0x18,0x08,0x08,0x88,0x68,0x18,0x00,//7
0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00,//8
0x00,0xF0,0x08,0x08,0x08,0x10,0xE0,0x00,//9
0x00,0x00,0xC0,0x38,0xE0,0x00,0x00,0x00,//A0A 
0x08,0xF8,0x88,0x88,0x88,0x70,0x00,0x00,//B0B
0xC0,0x30,0x08,0x08,0x08,0x08,0x38,0x00,//C0C
0x08,0xF8,0x08,0x08,0x08,0x10,0xE0,0x00,//D0D
0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,//E0E
0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,//F0F
0xC0,0x30,0x08,0x08,0x08,0x38,0x00,0x00,//G10
0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,//H11
0x00,0x08,0x08,0xF8,0x08,0x08,0x00,0x00,//I12
0x00,0x00,0x08,0x08,0xF8,0x08,0x08,0x00,//J13
0x08,0xF8,0x88,0xC0,0x28,0x18,0x08,0x00,//K14
0x08,0xF8,0x08,0x00,0x00,0x00,0x00,0x00,//L15
0x08,0xF8,0xF8,0x00,0xF8,0xF8,0x08,0x00,//M16
0x08,0xF8,0x30,0xC0,0x00,0x08,0xF8,0x08,//N17
0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,//O18
0x08,0xF8,0x08,0x08,0x08,0x08,0xF0,0x00,//P19	
0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,//Q1A
0x08,0xF8,0x88,0x88,0x88,0x88,0x70,0x00,//R1B
0x00,0x70,0x88,0x08,0x08,0x08,0x38,0x00,//S1C
0x18,0x08,0x08,0xF8,0x08,0x08,0x18,0x00,//T1D
0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,//U1E
0x08,0x78,0x88,0x00,0x00,0xC8,0x38,0x08,//V1F
0x08,0xF8,0x00,0xF8,0x00,0xF8,0x08,0x00,//W20
0x08,0x18,0x68,0x80,0x80,0x68,0x18,0x08,//X21
0x08,0x38,0xC8,0x00,0xC8,0x38,0x08,0x00,//Y22
0x10,0x08,0x08,0x08,0xC8,0x38,0x08,0x00,//Z23
0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,//24    xiaolian  shangbu
0x00,0xC0,0x00,0x00,0x00,0x00,0x00,0xC0,//25    xiaolian xiabu
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,// 26
0x00,0x00,0xC0,0x38,0xE0,0x00,0x00,0x00,//a27
0x08,0xF8,0x88,0x88,0x88,0x70,0x00,0x00,//b28
0xC0,0x30,0x08,0x08,0x08,0x08,0x38,0x00,//c29
0x08,0xF8,0x08,0x08,0x08,0x10,0xE0,0x00,//d2A
0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,//e2B
0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,//f2C
0xC0,0x30,0x08,0x08,0x08,0x38,0x00,0x00,//g2D
0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,//h2E
0x00,0x08,0x08,0xF8,0x08,0x08,0x00,0x00,//i2F
0x00,0x00,0x08,0x08,0xF8,0x08,0x08,0x00,//J30
0x08,0xF8,0x88,0xC0,0x28,0x18,0x08,0x00,//K31
0x08,0xF8,0x08,0x00,0x00,0x00,0x00,0x00,//L32
0x08,0xF8,0xF8,0x00,0xF8,0xF8,0x08,0x00,//M33
0x08,0xF8,0x30,0xC0,0x00,0x08,0xF8,0x08,//N34
0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,//O35
0x08,0xF8,0x08,0x08,0x08,0x08,0xF0,0x00,//P36	
0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,//Q37
0x08,0xF8,0x88,0x88,0x88,0x88,0x70,0x00,//R38
0x00,0x70,0x88,0x08,0x08,0x08,0x38,0x00,//S39
0x18,0x08,0x08,0xF8,0x08,0x08,0x18,0x00,//T3A
0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,//U3B
0x08,0x78,0x88,0x00,0x00,0xC8,0x38,0x08,//V3C
0x08,0xF8,0x00,0xF8,0x00,0xF8,0x08,0x00,//W3D
0x08,0x18,0x68,0x80,0x80,0x68,0x18,0x08,//X3E
0x08,0x38,0xC8,0x00,0xC8,0x38,0x08,0x00,//Y3F
0x10,0x08,0x08,0x08,0xC8,0x38,0x08,0x00,//Z40
0x08,0xF8,0x00,0xF8,0x00,0xF8,0x08,0x00,//,41
0x08,0x18,0x68,0x80,0x80,0x68,0x18,0x08,//.42
0x08,0x38,0xC8,0x00,0xC8,0x38,0x08,0x00,//!43
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,// 44

};
PROGMEM const  char  shuziTab2[]  = {
  0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00,//0 
  0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00,//1
  0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00,//2,
  0x00,0x18,0x20,0x21,0x21,0x22,0x1C,0x00,//3
  0x00,0x06,0x05,0x24,0x24,0x3F,0x24,0x24,//4
  0x00,0x19,0x20,0x20,0x20,0x11,0x0E,0x00,//5
  0x00,0x0F,0x11,0x20,0x20,0x20,0x1F,0x00,//6
  0x00,0x00,0x00,0x3E,0x01,0x00,0x00,0x00,//7
  0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00,//8
  0x00,0x01,0x12,0x22,0x22,0x11,0x0F,0x00,//9  
  0x20,0x3C,0x23,0x02,0x02,0x27,0x38,0x20,//A0A
  0x20,0x3F,0x20,0x20,0x20,0x11,0x0E,0x00,//B0B
  0x07,0x18,0x20,0x20,0x20,0x10,0x08,0x00,//C0C
  0x20,0x3F,0x20,0x20,0x20,0x10,0x0F,0x00,//D0D
  0x20,0x3F,0x20,0x20,0x23,0x20,0x18,0x00,//E0E
  0x20,0x3F,0x20,0x00,0x03,0x00,0x00,0x00,//F0F
  0x07,0x18,0x20,0x20,0x22,0x1E,0x02,0x00,//G10
  0x20,0x3F,0x21,0x01,0x01,0x21,0x3F,0x20,//H11
  0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,//I12
  0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,0x00,//J13
  0x20,0x3F,0x20,0x01,0x26,0x38,0x20,0x00,//K14
  0x20,0x3F,0x20,0x20,0x20,0x20,0x30,0x00,//L15
  0x20,0x3F,0x01,0x3E,0x01,0x3F,0x20,0x00,//M16
  0x20,0x3F,0x20,0x00,0x07,0x18,0x3F,0x00,//N17
  0x0F,0x10,0x20,0x20,0x20,0x10,0x0F,0x00,//O18
  0x20,0x3F,0x21,0x01,0x01,0x01,0x00,0x00,//P19
  0x0F,0x10,0x28,0x28,0x30,0x50,0x4F,0x00,//Q1A
  0x20,0x3F,0x20,0x00,0x03,0x0C,0x30,0x20,//R1B
  0x00,0x38,0x20,0x21,0x21,0x22,0x1C,0x00,//S1C
  0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,//T1D
  0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,//U1E
  0x00,0x00,0x07,0x38,0x0E,0x01,0x00,0x00,//V1F
  0x00,0x03,0x3E,0x01,0x3E,0x03,0x00,0x00,//W20
  0x20,0x30,0x2C,0x03,0x03,0x2C,0x30,0x20,//X21
  0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,//Y22
  0x20,0x38,0x26,0x21,0x20,0x20,0x18,0x00,//Z23
  0x04,0x02,0x01,0x00,0x01,0x02,0x04,0x00,//v,24      //xiaolian  shangbu
  0x00,0x00,0x03,0x0C,0x10,0x0C,0x03,0x00,//v,25     //xiaolian xiabu
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,// 26
  0x20,0x3C,0x23,0x02,0x02,0x27,0x38,0x20,//A27
  0x20,0x3F,0x20,0x20,0x20,0x11,0x0E,0x00,//B28
  0x07,0x18,0x20,0x20,0x20,0x10,0x08,0x00,//C29
  0x20,0x3F,0x20,0x20,0x20,0x10,0x0F,0x00,//D2A
  0x20,0x3F,0x20,0x20,0x23,0x20,0x18,0x00,//E2B
  0x20,0x3F,0x20,0x00,0x03,0x00,0x00,0x00,//F2C
  0x07,0x18,0x20,0x20,0x22,0x1E,0x02,0x00,//G2D
  0x20,0x3F,0x21,0x01,0x01,0x21,0x3F,0x20,//H2E
  0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00,//I2F
  0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,0x00,//J30
  0x20,0x3F,0x20,0x01,0x26,0x38,0x20,0x00,//K31
  0x20,0x3F,0x20,0x20,0x20,0x20,0x30,0x00,//L32
  0x20,0x3F,0x01,0x3E,0x01,0x3F,0x20,0x00,//M33
  0x20,0x3F,0x20,0x00,0x07,0x18,0x3F,0x00,//N34
  0x0F,0x10,0x20,0x20,0x20,0x10,0x0F,0x00,//O35
  0x20,0x3F,0x21,0x01,0x01,0x01,0x00,0x00,//P36
  0x0F,0x10,0x28,0x28,0x30,0x50,0x4F,0x00,//Q37
  0x20,0x3F,0x20,0x00,0x03,0x0C,0x30,0x20,//R38
  0x00,0x38,0x20,0x21,0x21,0x22,0x1C,0x00,//S39
  0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,//T3A
  0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00,//U3B
  0x00,0x00,0x07,0x38,0x0E,0x01,0x00,0x00,//V3C
  0x00,0x03,0x3E,0x01,0x3E,0x03,0x00,0x00,//W3D
  0x20,0x30,0x2C,0x03,0x03,0x2C,0x30,0x20,//X3E
  0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00,//Y3F
  0x20,0x38,0x26,0x21,0x20,0x20,0x18,0x00,//Z40
  0x08,0xF8,0x00,0xF8,0x00,0xF8,0x08,0x00,//,41
  0x08,0x18,0x68,0x80,0x80,0x68,0x18,0x08,//.42
  0x00,0x00,0x00,0xff,0xff,0x00,0x00,0x00,//!43
  0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,// 44
};


PROGMEM const  char  shuziTab[]  = {                    //xiaoxing
0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E,// 0
0x00, 0x00, 0x42, 0x7F, 0x40, 0x00,// 1
0x00, 0x42, 0x61, 0x51, 0x49, 0x46,// 2
0x00, 0x21, 0x41, 0x45, 0x4B, 0x31,// 3
0x00, 0x18, 0x14, 0x12, 0x7F, 0x10,// 4
0x00, 0x27, 0x45, 0x45, 0x45, 0x39,// 5
0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30,// 6
0x00, 0x01, 0x71, 0x09, 0x05, 0x03,// 7
0x00, 0x36, 0x49, 0x49, 0x49, 0x36,// 8
0x00, 0x06, 0x49, 0x49, 0x29, 0x1E,// 9
0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C,// A 10
0x00, 0x7F, 0x49, 0x49, 0x49, 0x36,// B11
0x00, 0x3E, 0x41, 0x41, 0x41, 0x22,// C12
0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C,// D13
0x00, 0x7F, 0x49, 0x49, 0x49, 0x41,// E14
0x00, 0x7F, 0x09, 0x09, 0x09, 0x01,// F15
0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A,// G16
0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F,// H17
0x00, 0x00, 0x41, 0x7F, 0x41, 0x00,// I18
0x00, 0x20, 0x40, 0x41, 0x3F, 0x01,// J19
0x00, 0x7F, 0x08, 0x14, 0x22, 0x41,// K20
0x00, 0x7F, 0x40, 0x40, 0x40, 0x40,// L21
0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F,// M22
0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F,// N23
0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E,// O24
0x00, 0x7F, 0x09, 0x09, 0x09, 0x06,// P25
0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E,// Q26
0x00, 0x7F, 0x09, 0x19, 0x29, 0x46,// R27
0x00, 0x46, 0x49, 0x49, 0x49, 0x31,// S28
0x00, 0x01, 0x01, 0x7F, 0x01, 0x01,// T29
0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F,// U30
0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F,// V31
0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F,// W32
0x00, 0x63, 0x14, 0x08, 0x14, 0x63,// X33
0x00, 0x07, 0x08, 0x70, 0x08, 0x07,// Y34
0x00, 0x61, 0x51, 0x49, 0x45, 0x43,// Z35
0x00, 0x00, 0x00, 0x00, 0x00, 0x00,// 36

 };
void  LOOL_OLED::LCD_shuzi_1(uint8_t ch)
{    
	if(ch>=0x31&&ch<=0x4a)
	{
     ch=ch-39;
	}
	if(ch==0xF0)
    {
    ch=0x44;
	}
	if(ch==0xf1)
		{
		ch=0x43;
		}
	if(ch==0xfc)
		{
		ch=0x42;
		}
	if(ch==0xfe)
		{
		ch=0x41;
		}
    Wire.beginTransmission(_i2caddr);
    Wire.write(0x40);   
	unsigned char i=0,j=0,ss=0;		
		for(i=0;i<8;i++)
               {
                ss=pgm_read_byte(shuziTab1+ch*8+i);
                Wire.write(ss);
              }
              Wire.endTransmission();
}
void  LOOL_OLED::LCD_shuzi_2(uint8_t cch)
{
	if(cch>=0x31&&cch<=0x4a)
	{
     cch=cch-39;
	}
	if(cch==0xF0)
		{
		cch=0x44;
		}
	if(cch==0xf1)
		{
		cch=0x43;
		}
	if(cch==0xfc)
		{
		cch=0x42;
		}
	if(cch==0xfe)
		{
		cch=0x41;
		}		
    Wire.beginTransmission(_i2caddr);
    Wire.write(0x40);   
	uint8_t i=0,j=0,ss=0;		
	for(i=0;i<8;i++)
     {
      ss=pgm_read_byte(shuziTab2+cch*8+i);
      Wire.write(ss);                      
     }
     Wire.endTransmission();
}
void  LOOL_OLED::LCD_Num(uint8_t ch,uint8_t  x,uint8_t y)
{
     y=y%4;
	 Set_Pos(x,y*2);
     LCD_shuzi_1(ch);
     Set_Pos(x,y*2+1);
     LCD_shuzi_2(ch);

}
void  LOOL_OLED::LCD_Number(uint16_t ch,uint8_t  x,uint8_t y)
{
	uint8_t num1=0,num2=0,num3=0,num4=0,num5=0;
	num1 = ch/10000;
	num2 = (ch%10000)/1000;
	num3 = (ch%1000)/100;
	num4 = (ch%100)/10;
	num5 = ch%10;
	
	 y=y%4;
	 if(num1!=0)
	 {
	 if(x>126){x=0;y++;}
	 Set_Pos(x,y*2);
     LCD_shuzi_1(num1);
     Set_Pos(x,y*2+1);
     LCD_shuzi_2(num1);
	 x+=8;
	 }
	 if(num1==0 && num2==0)
	 {}
     else
	 {
	 if(x>126){x=0;y++;}
	 Set_Pos(x,y*2);
     LCD_shuzi_1(num2);
     Set_Pos(x,y*2+1);
     LCD_shuzi_2(num2);
	 x+=8;
	 }
	if(num1==0 && num2==0 && num3==0)
	 {}
     else
	 {
	 if(x>126){x=0;y++;}
	 Set_Pos(x,y*2);
     LCD_shuzi_1(num3);
     Set_Pos(x,y*2+1);
     LCD_shuzi_2(num3);
	 x+=8;
	 }
	if(num1==0 && num2==0 && num3==0&&num4==0)
	 {}
     else
	 {
	 if(x>126){x=0;y++;}
	 Set_Pos(x,y*2);
     LCD_shuzi_1(num4);
     Set_Pos(x,y*2+1);
     LCD_shuzi_2(num4);
	 x+=8;
	 }
	if(num1==0 && num2==0 && num3==0&&num4==0&&num5==0)
	 {}
     else
	 {
	 if(x>126){x=0;y++;}
	 Set_Pos(x,y*2);
     LCD_shuzi_1(num5);
     Set_Pos(x,y*2+1);
     LCD_shuzi_2(num5);
	 x+=8;
	 }
}
void LOOL_OLED::LCD_Str(char ch[],uint8_t x,uint8_t y)
{
	uint8_t c=0,i=0,j=0;
	while (ch[j]!='\0')
	{
		if(ch[j]>=65 && ch[j]<=122)
		{
		if(ch[j]>=97)
		  ch[j]=ch[j]-32;
		c =ch[j]-55;
		if(x>126){x=0;y++;}
		Set_Pos(x,y*2);
		LCD_shuzi_1(c);
        Set_Pos(x,y*2+1);
        LCD_shuzi_2(c);
		x+=8;
		}
		else if(ch[j]>=48 && ch[j]<=58)
		{
		c =ch[j]-48;
		if(x>126){x=0;y++;}
		Set_Pos(x,y*2);
		LCD_shuzi_1(c);
        Set_Pos(x,y*2+1);
        LCD_shuzi_2(c);
		x+=8;
		}
	    else
		{
		if(x>126){x=0;y++;}
		Set_Pos(x,y*2);
		LCD_shuzi_1(38);
        Set_Pos(x,y*2+1);
        LCD_shuzi_2(38);
		x+=8;	
		}
		j++;
	}
}
void LOOL_OLED::LCD_Str(uint8_t ch[],uint8_t length,uint8_t y)
{
	uint8_t x=0;
    for(uint8_t j=0;j<length;j++)
        {
		if(x>126){x=0;y++;}
		Set_Pos(x,y);
		LCD_shuzi_1(ch[j]);
        Set_Pos(x,y+1);
        LCD_shuzi_2(ch[j]);
		x+=10;
  }
}
void LOOL_OLED::expression()
{
   LCD_Num(36,50,1);
   LCD_Num(36,70,1);
   LCD_Num(37,60,2);
   LCD_Num(17,40,3);
   LCD_Num(14,50,3);
   LCD_Num(21,60,3);
   LCD_Num(21,70,3);
   LCD_Num(24,80,3);
   LCD_Num(21,30,0);
   LCD_Num(24,40,0);
   LCD_Num(24,50,0);
   LCD_Num(21,60,0);
   LCD_Num(21,70,0);
   LCD_Num(24,80,0);
   LCD_Num(24,90,0);
   LCD_Num(21,100,0); 
}